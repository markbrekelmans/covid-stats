{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "description": "A simple line chart",
  "width": 900,
  "heigh": 500,
  "data": {
    "url": "/data/COVID-19_aantallen_gemeente_cumulatief.csv",
    "format": {
      "type": "dsv",
      "delimiter": ";",
      "parse": {
        "Date_of_report": "date:%Y-%m-%d %H:%M:%S"
      }
    }
  },
  "transform": [
    {
      "joinaggregate": [{
        "op": "sum",
        "field": "Total_reported",
        "as": "total_cases"
      }],
      "groupby": ["Date_of_report"]
    },
    {
      "calculate": "datum.total_cases",
      "as": "delta_cases"
    },
    {
      "window": [{
        "op": "row_number",
        "field": "Total_reported",
        "as": "new_cases"
      }],
      "groupby": ["Date_of_report"],
      "frame": [null,null],
      "sort": [{"field": "Date_of_report", "order": "ascending"}]
    }
  ],
  "layer": [
    {
      "mark": "line",
      "encoding": {
        "x": {
          "timeUnit": "yearmonthdate",
          "field": "Date_of_report"
        },
        "y": {
          "field": "new_cases",
          "type": "quantitative"
        }
      }
    }
  ]
}
